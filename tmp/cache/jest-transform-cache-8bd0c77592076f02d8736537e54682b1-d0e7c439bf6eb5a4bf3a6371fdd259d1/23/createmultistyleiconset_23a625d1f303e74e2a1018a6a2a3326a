3e1958b574e8b296c88eed20b1664e6e
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = createMultiStyleIconSet;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _createIconSet = _interopRequireWildcard(require("./create-icon-set"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function createMultiStyleIconSet(styles) {
  var optionsInput = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var styleNames = Object.keys(styles);

  if (styleNames.length === 0) {
    throw new Error('You need to add at least one style');
  }

  var options = _objectSpread({
    defaultStyle: styleNames[0],
    fallbackFamily: function fallbackFamily() {
      return styleNames[0];
    },
    glyphValidator: function glyphValidator() {
      return true;
    }
  }, optionsInput);

  var iconSets = styleNames.reduce(function (acc, name) {
    var style = styles[name];
    acc[name] = (0, _createIconSet["default"])(style.glyphMap || {}, style.fontFamily || '', style.fontFile || '', style.fontStyle || {});
    return acc;
  }, {});

  function styleFromProps(props) {
    return Object.keys(props).reduce(function (result, propName) {
      return styleNames.indexOf(propName) !== -1 && props[propName] === true ? propName : result;
    }, options.defaultStyle);
  }

  function getIconSetForProps(props) {
    var name = props.name;
    var style = styleFromProps(props);
    if (options.glyphValidator(name, style)) return iconSets[style];
    var family = options.fallbackFamily(name);

    if (styleNames.indexOf(family) === -1) {
      return options.defaultStyle;
    }

    return iconSets[family];
  }

  function selectIconClass(iconSet, iconClass) {
    return iconClass.length > 0 ? iconSet[iconClass] : iconSet;
  }

  function reduceProps(props) {
    return Object.keys(props).reduce(function (acc, prop) {
      if (styleNames.indexOf(prop) === -1) {
        acc[prop] = props[prop];
      }

      return acc;
    }, {});
  }

  function getStyledIconSet(style) {
    var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';

    if (styleNames.indexOf(style) === -1) {
      return iconSets[options.defaultStyle];
    }

    return !name ? iconSets[styleFromProps((0, _defineProperty2["default"])({}, style, true))] : getIconSetForProps((0, _defineProperty2["default"])({
      name: name
    }, style, true));
  }

  function getImageSource(name) {
    var size = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _createIconSet.DEFAULT_ICON_SIZE;
    var color = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : _createIconSet.DEFAULT_ICON_COLOR;
    var style = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : options.defaultStyle;
    return getStyledIconSet(style, name).getImageSource(name, size, color);
  }

  function getFontFamily() {
    var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : options.defaultStyle;
    return getStyledIconSet(style).getFontFamily();
  }

  function getRawGlyphMap() {
    var style = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : options.defaultStyle;
    return getStyledIconSet(style).getRawGlyphMap();
  }

  function hasIcon(name) {
    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : options.defaultStyle;
    return options.glyphValidator(name, style);
  }

  function createStyledIconClass() {
    var selectClass = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

    var IconClass = function (_PureComponent) {
      (0, _inherits2["default"])(IconClass, _PureComponent);

      function IconClass() {
        (0, _classCallCheck2["default"])(this, IconClass);
        return (0, _possibleConstructorReturn2["default"])(this, (0, _getPrototypeOf2["default"])(IconClass).apply(this, arguments));
      }

      (0, _createClass2["default"])(IconClass, [{
        key: "render",
        value: function render() {
          var selectedIconSet = getIconSetForProps(this.props);
          var SelectedIconClass = selectIconClass(selectedIconSet, selectClass);
          var props = reduceProps(this.props);
          return _react["default"].createElement(SelectedIconClass, props);
        }
      }]);
      return IconClass;
    }(_react.PureComponent);

    IconClass.propTypes = styleNames.reduce(function (acc, name) {
      acc[name] = _propTypes["default"].bool;
      return acc;
    }, {});
    IconClass.defaultProps = styleNames.reduce(function (acc, name) {
      acc[name] = false;
      return acc;
    }, {});
    return IconClass;
  }

  var Icon = createStyledIconClass();
  Icon.Button = createStyledIconClass('Button');
  Icon.TabBarItem = createStyledIconClass('TabBarItem');
  Icon.TabBarItemIOS = createStyledIconClass('TabBarItemIOS');
  Icon.ToolbarAndroid = createStyledIconClass('ToolbarAndroid');
  Icon.getStyledIconSet = getStyledIconSet;
  Icon.getImageSource = getImageSource;
  Icon.getFontFamily = getFontFamily;
  Icon.getRawGlyphMap = getRawGlyphMap;
  Icon.hasIcon = hasIcon;
  return Icon;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZS1tdWx0aS1zdHlsZS1pY29uLXNldC5qcyJdLCJuYW1lcyI6WyJjcmVhdGVNdWx0aVN0eWxlSWNvblNldCIsInN0eWxlcyIsIm9wdGlvbnNJbnB1dCIsInN0eWxlTmFtZXMiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiRXJyb3IiLCJvcHRpb25zIiwiZGVmYXVsdFN0eWxlIiwiZmFsbGJhY2tGYW1pbHkiLCJnbHlwaFZhbGlkYXRvciIsImljb25TZXRzIiwicmVkdWNlIiwiYWNjIiwibmFtZSIsInN0eWxlIiwiZ2x5cGhNYXAiLCJmb250RmFtaWx5IiwiZm9udEZpbGUiLCJmb250U3R5bGUiLCJzdHlsZUZyb21Qcm9wcyIsInByb3BzIiwicmVzdWx0IiwicHJvcE5hbWUiLCJpbmRleE9mIiwiZ2V0SWNvblNldEZvclByb3BzIiwiZmFtaWx5Iiwic2VsZWN0SWNvbkNsYXNzIiwiaWNvblNldCIsImljb25DbGFzcyIsInJlZHVjZVByb3BzIiwicHJvcCIsImdldFN0eWxlZEljb25TZXQiLCJnZXRJbWFnZVNvdXJjZSIsInNpemUiLCJERUZBVUxUX0lDT05fU0laRSIsImNvbG9yIiwiREVGQVVMVF9JQ09OX0NPTE9SIiwiZ2V0Rm9udEZhbWlseSIsImdldFJhd0dseXBoTWFwIiwiaGFzSWNvbiIsImNyZWF0ZVN0eWxlZEljb25DbGFzcyIsInNlbGVjdENsYXNzIiwiSWNvbkNsYXNzIiwic2VsZWN0ZWRJY29uU2V0IiwiU2VsZWN0ZWRJY29uQ2xhc3MiLCJQdXJlQ29tcG9uZW50IiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwiYm9vbCIsImRlZmF1bHRQcm9wcyIsIkljb24iLCJCdXR0b24iLCJUYWJCYXJJdGVtIiwiVGFiQmFySXRlbUlPUyIsIlRvb2xiYXJBbmRyb2lkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQTs7Ozs7O0FBS2UsU0FBU0EsdUJBQVQsQ0FBaUNDLE1BQWpDLEVBQTREO0FBQUEs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QztBQUNBVSxFQUFBQSxJQUFJLENBQUNDLE1BQUwsR0FBY1gscUJBQXFCLENBQUMsUUFBRCxDQUFuQztBQUNBVSxFQUFBQSxJQUFJLENBQUNFLFVBQUwsR0FBa0JaLHFCQUFxQixDQUFDLFlBQUQsQ0FBdkM7QUFDQVUsRUFBQUEsSUFBSSxDQUFDRyxhQUFMLEdBQXFCYixxQkFBcUIsQ0FBQyxlQUFELENBQTFDO0FBQ0FVLEVBQUFBLElBQUksQ0FBQ0ksY0FBTCxHQUFzQmQscUJBQXFCLENBQUMsZ0JBQUQsQ0FBM0M7QUFDQVUsRUFBQUEsSUFBSSxDQUFDbkIsZ0JBQUwsR0FBd0JBLGdCQUF4QjtBQUNBbUIsRUFBQUEsSUFBSSxDQUFDbEIsY0FBTCxHQUFzQkEsY0FBdEI7QUFDQWtCLEVBQUFBLElBQUksQ0FBQ2IsYUFBTCxHQUFxQkEsYUFBckI7QUFDQWEsRUFBQUEsSUFBSSxDQUFDWixjQUFMLEdBQXNCQSxjQUF0QjtBQUNBWSxFQUFBQSxJQUFJLENBQUNYLE9BQUwsR0FBZUEsT0FBZjtBQUVBLFNBQU9XLElBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBQdXJlQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcblxuaW1wb3J0IGNyZWF0ZUljb25TZXQsIHtcbiAgREVGQVVMVF9JQ09OX0NPTE9SLFxuICBERUZBVUxUX0lDT05fU0laRSxcbn0gZnJvbSAnLi9jcmVhdGUtaWNvbi1zZXQnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjcmVhdGVNdWx0aVN0eWxlSWNvblNldChzdHlsZXMsIG9wdGlvbnNJbnB1dCA9IHt9KSB7XG4gIGNvbnN0IHN0eWxlTmFtZXMgPSBPYmplY3Qua2V5cyhzdHlsZXMpO1xuXG4gIGlmIChzdHlsZU5hbWVzLmxlbmd0aCA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignWW91IG5lZWQgdG8gYWRkIGF0IGxlYXN0IG9uZSBzdHlsZScpO1xuICB9XG5cbiAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICBkZWZhdWx0U3R5bGU6IHN0eWxlTmFtZXNbMF0sXG4gICAgZmFsbGJhY2tGYW1pbHk6ICgpID0+IHN0eWxlTmFtZXNbMF0sXG4gICAgZ2x5cGhWYWxpZGF0b3I6ICgpID0+IHRydWUsXG4gICAgLi4ub3B0aW9uc0lucHV0LFxuICB9O1xuXG4gIGNvbnN0IGljb25TZXRzID0gc3R5bGVOYW1lcy5yZWR1Y2UoKGFjYywgbmFtZSkgPT4ge1xuICAgIGNvbnN0IHN0eWxlID0gc3R5bGVzW25hbWVdO1xuXG4gICAgYWNjW25hbWVdID0gY3JlYXRlSWNvblNldChcbiAgICAgIHN0eWxlLmdseXBoTWFwIHx8IHt9LFxuICAgICAgc3R5bGUuZm9udEZhbWlseSB8fCAnJyxcbiAgICAgIHN0eWxlLmZvbnRGaWxlIHx8ICcnLFxuICAgICAgc3R5bGUuZm9udFN0eWxlIHx8IHt9XG4gICAgKTtcblxuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcblxuICBmdW5jdGlvbiBzdHlsZUZyb21Qcm9wcyhwcm9wcykge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhwcm9wcykucmVkdWNlKFxuICAgICAgKHJlc3VsdCwgcHJvcE5hbWUpID0+XG4gICAgICAgIHN0eWxlTmFtZXMuaW5kZXhPZihwcm9wTmFtZSkgIT09IC0xICYmIHByb3BzW3Byb3BOYW1lXSA9PT0gdHJ1ZVxuICAgICAgICAgID8gcHJvcE5hbWVcbiAgICAgICAgICA6IHJlc3VsdCxcbiAgICAgIG9wdGlvbnMuZGVmYXVsdFN0eWxlXG4gICAgKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEljb25TZXRGb3JQcm9wcyhwcm9wcykge1xuICAgIGNvbnN0IHsgbmFtZSB9ID0gcHJvcHM7XG4gICAgY29uc3Qgc3R5bGUgPSBzdHlsZUZyb21Qcm9wcyhwcm9wcyk7XG5cbiAgICBpZiAob3B0aW9ucy5nbHlwaFZhbGlkYXRvcihuYW1lLCBzdHlsZSkpIHJldHVybiBpY29uU2V0c1tzdHlsZV07XG5cbiAgICBjb25zdCBmYW1pbHkgPSBvcHRpb25zLmZhbGxiYWNrRmFtaWx5KG5hbWUpO1xuXG4gICAgaWYgKHN0eWxlTmFtZXMuaW5kZXhPZihmYW1pbHkpID09PSAtMSkge1xuICAgICAgcmV0dXJuIG9wdGlvbnMuZGVmYXVsdFN0eWxlO1xuICAgIH1cblxuICAgIHJldHVybiBpY29uU2V0c1tmYW1pbHldO1xuICB9XG5cbiAgZnVuY3Rpb24gc2VsZWN0SWNvbkNsYXNzKGljb25TZXQsIGljb25DbGFzcykge1xuICAgIHJldHVybiBpY29uQ2xhc3MubGVuZ3RoID4gMCA/IGljb25TZXRbaWNvbkNsYXNzXSA6IGljb25TZXQ7XG4gIH1cblxuICBmdW5jdGlvbiByZWR1Y2VQcm9wcyhwcm9wcykge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhwcm9wcykucmVkdWNlKChhY2MsIHByb3ApID0+IHtcbiAgICAgIGlmIChzdHlsZU5hbWVzLmluZGV4T2YocHJvcCkgPT09IC0xKSB7XG4gICAgICAgIGFjY1twcm9wXSA9IHByb3BzW3Byb3BdO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFN0eWxlZEljb25TZXQoc3R5bGUsIG5hbWUgPSAnJykge1xuICAgIGlmIChzdHlsZU5hbWVzLmluZGV4T2Yoc3R5bGUpID09PSAtMSkge1xuICAgICAgcmV0dXJuIGljb25TZXRzW29wdGlvbnMuZGVmYXVsdFN0eWxlXTtcbiAgICB9XG5cbiAgICByZXR1cm4gIW5hbWVcbiAgICAgID8gaWNvblNldHNbc3R5bGVGcm9tUHJvcHMoeyBbc3R5bGVdOiB0cnVlIH0pXVxuICAgICAgOiBnZXRJY29uU2V0Rm9yUHJvcHMoeyBuYW1lLCBbc3R5bGVdOiB0cnVlIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0SW1hZ2VTb3VyY2UoXG4gICAgbmFtZSxcbiAgICBzaXplID0gREVGQVVMVF9JQ09OX1NJWkUsXG4gICAgY29sb3IgPSBERUZBVUxUX0lDT05fQ09MT1IsXG4gICAgc3R5bGUgPSBvcHRpb25zLmRlZmF1bHRTdHlsZVxuICApIHtcbiAgICByZXR1cm4gZ2V0U3R5bGVkSWNvblNldChzdHlsZSwgbmFtZSkuZ2V0SW1hZ2VTb3VyY2UobmFtZSwgc2l6ZSwgY29sb3IpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Rm9udEZhbWlseShzdHlsZSA9IG9wdGlvbnMuZGVmYXVsdFN0eWxlKSB7XG4gICAgcmV0dXJuIGdldFN0eWxlZEljb25TZXQoc3R5bGUpLmdldEZvbnRGYW1pbHkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFJhd0dseXBoTWFwKHN0eWxlID0gb3B0aW9ucy5kZWZhdWx0U3R5bGUpIHtcbiAgICByZXR1cm4gZ2V0U3R5bGVkSWNvblNldChzdHlsZSkuZ2V0UmF3R2x5cGhNYXAoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhc0ljb24obmFtZSwgc3R5bGUgPSBvcHRpb25zLmRlZmF1bHRTdHlsZSkge1xuICAgIHJldHVybiBvcHRpb25zLmdseXBoVmFsaWRhdG9yKG5hbWUsIHN0eWxlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVN0eWxlZEljb25DbGFzcyhzZWxlY3RDbGFzcyA9ICcnKSB7XG4gICAgY2xhc3MgSWNvbkNsYXNzIGV4dGVuZHMgUHVyZUNvbXBvbmVudCB7XG4gICAgICBzdGF0aWMgcHJvcFR5cGVzID0gc3R5bGVOYW1lcy5yZWR1Y2UoKGFjYywgbmFtZSkgPT4ge1xuICAgICAgICBhY2NbbmFtZV0gPSBQcm9wVHlwZXMuYm9vbDtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sIHt9KTtcblxuICAgICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHN0eWxlTmFtZXMucmVkdWNlKChhY2MsIG5hbWUpID0+IHtcbiAgICAgICAgYWNjW25hbWVdID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9LCB7fSk7XG5cbiAgICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRJY29uU2V0ID0gZ2V0SWNvblNldEZvclByb3BzKHRoaXMucHJvcHMpO1xuICAgICAgICBjb25zdCBTZWxlY3RlZEljb25DbGFzcyA9IHNlbGVjdEljb25DbGFzcyhzZWxlY3RlZEljb25TZXQsIHNlbGVjdENsYXNzKTtcbiAgICAgICAgY29uc3QgcHJvcHMgPSByZWR1Y2VQcm9wcyh0aGlzLnByb3BzKTtcblxuICAgICAgICByZXR1cm4gPFNlbGVjdGVkSWNvbkNsYXNzIHsuLi5wcm9wc30gLz47XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIEljb25DbGFzcztcbiAgfVxuXG4gIGNvbnN0IEljb24gPSBjcmVhdGVTdHlsZWRJY29uQ2xhc3MoKTtcbiAgSWNvbi5CdXR0b24gPSBjcmVhdGVTdHlsZWRJY29uQ2xhc3MoJ0J1dHRvbicpO1xuICBJY29uLlRhYkJhckl0ZW0gPSBjcmVhdGVTdHlsZWRJY29uQ2xhc3MoJ1RhYkJhckl0ZW0nKTtcbiAgSWNvbi5UYWJCYXJJdGVtSU9TID0gY3JlYXRlU3R5bGVkSWNvbkNsYXNzKCdUYWJCYXJJdGVtSU9TJyk7XG4gIEljb24uVG9vbGJhckFuZHJvaWQgPSBjcmVhdGVTdHlsZWRJY29uQ2xhc3MoJ1Rvb2xiYXJBbmRyb2lkJyk7XG4gIEljb24uZ2V0U3R5bGVkSWNvblNldCA9IGdldFN0eWxlZEljb25TZXQ7XG4gIEljb24uZ2V0SW1hZ2VTb3VyY2UgPSBnZXRJbWFnZVNvdXJjZTtcbiAgSWNvbi5nZXRGb250RmFtaWx5ID0gZ2V0Rm9udEZhbWlseTtcbiAgSWNvbi5nZXRSYXdHbHlwaE1hcCA9IGdldFJhd0dseXBoTWFwO1xuICBJY29uLmhhc0ljb24gPSBoYXNJY29uO1xuXG4gIHJldHVybiBJY29uO1xufVxuIl19